<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Issue Tracker Helpdesk</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root{
 --primary:#1e88e5;
 --secondary:#42a5f5;
 --soft:#f5f9ff;
 --dark:#0d47a1;
}

*{box-sizing:border-box}

body{
 font-family:"Inter",Arial,sans-serif;
 background:linear-gradient(135deg,#e3f2fd,#ffffff,#e3f2fd);
 margin:0;
 color:#333;
}

/* CONTAINER */
.container{
 max-width:980px;
 margin:40px auto;
 padding:28px;
 background:rgba(255,255,255,.88);
 backdrop-filter:blur(12px);
 border-radius:18px;
 box-shadow:0 20px 40px rgba(0,0,0,.12);
}

/* HEADER */
.header{
 text-align:center;
 padding:34px 20px;
 border-radius:18px;
 background:linear-gradient(135deg,var(--primary),var(--secondary));
 color:#fff;
 position:relative;
 overflow:hidden;
}

.header::after{
 content:"";
 position:absolute;
 inset:0;
 background:radial-gradient(circle at top,rgba(255,255,255,.35),transparent 60%);
}

.icon-wrap{
 position:relative;
 z-index:2;
 margin-bottom:10px;
}

.book{
 font-size:60px;
 animation:float 3s ease-in-out infinite;
}

.gear{
 position:absolute;
 right:-30px;
 bottom:-10px;
 font-size:34px;
 animation:spin 3s linear infinite;
}

@keyframes spin{
 from{transform:rotate(0)}
 to{transform:rotate(360deg)}
}

@keyframes float{
 0%,100%{transform:translateY(0)}
 50%{transform:translateY(-6px)}
}

/* SEARCH */
.search-wrap{
 margin:30px 0;
 position:relative;
}

.search-wrap input{
 width:100%;
 padding:16px 52px 16px 18px;
 border-radius:14px;
 border:1px solid #d0ddee;
 font-size:16px;
 outline:none;
 transition:.3s;
}

.search-wrap input:focus{
 border-color:var(--primary);
 box-shadow:0 0 0 4px rgba(30,136,229,.15);
}

.search-icon{
 position:absolute;
 right:16px;
 top:50%;
 transform:translateY(-50%);
 font-size:20px;
 color:#999;
}

/* ISSUE CARD */
.issue-item{
 margin-bottom:18px;
 border-radius:16px;
 background:#fff;
 box-shadow:0 12px 26px rgba(0,0,0,.08);
 overflow:hidden;
 animation:fadeUp .4s ease;
}

@keyframes fadeUp{
 from{opacity:0;transform:translateY(8px)}
 to{opacity:1;transform:none}
}

.issue-header{
 padding:18px 22px;
 cursor:pointer;
 display:flex;
 justify-content:space-between;
 align-items:center;
 font-weight:600;
 color:var(--dark);
 transition:.3s;
}

.issue-header:hover{
 background:var(--soft);
}

.arrow{
 font-size:20px;
 transition:.3s;
}

.issue-item.open .arrow{
 transform:rotate(90deg);
}

/* DETAIL */
.issue-detail{
 display:none;
 padding:22px;
 border-top:1px dashed #cfd8dc;
 background:#fbfdff;
 line-height:1.7;
}

.section h4{
 margin:0 0 8px;
 color:var(--primary);
 font-size:15px;
}

img{
 width:100%;
 border-radius:14px;
 margin-top:14px;
 box-shadow:0 10px 24px rgba(0,0,0,.15);
}

/* EMPTY */
.empty{
 color:#999;
 text-align:center;
 padding:30px;
}

/* FOOTER */
.footer{
 text-align:center;
 margin-top:40px;
 font-size:13px;
 color:#777;
}
</style>
</head>

<body>

<div class="container">

 <div class="header">
  <div class="icon-wrap">
   <span class="book">üìò</span>
   <span class="gear">‚öôÔ∏è</span>
  </div>
  <h1>Issue Tracker Helpdesk</h1>
  <p>Pusat solusi internal</p>
 </div>

 <div class="search-wrap">
  <input id="search" placeholder="Cari issue atau error...">
  <div class="search-icon">üîç</div>
 </div>

 <div id="list" class="empty">
  Ketik kata kunci untuk mencari issue
 </div>

 <div class="footer">
  ¬© Helpdesk <span id="year"></span>
 </div>

</div>

<script>
document.getElementById("year").textContent=new Date().getFullYear();

/* GOOGLE SHEET CSV */
const SHEET_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQCLXvz4_F7EfUppPoKWSKQawlesCjiYHhceQCIEDoV8ntbDjFrvKUorP416AGydpWYmxWlOLA3b1JL/pub?gid=0&single=true&output=csv&t="+Date.now();

let issues=[];

/* LOAD DATA */
Papa.parse(SHEET_URL,{
 download:true,
 header:true,
 skipEmptyLines:true,
 complete:r=>{
  issues=r.data.map(x=>({
   issue:(x.issue||"").trim(),
   solusi:(x.solusi||"").trim(),
   image_id:(x.image_id||"").trim()
  })).filter(i=>i.issue);
 }
});

/* newline -> <br> */
const nl=t=>t.replace(/\n/g,"<br>");

/* RENDER */
function render(data){
 const list=document.getElementById("list");
 list.innerHTML="";

 if(!data.length){
  list.innerHTML="<div class='empty'>Issue tidak ditemukan</div>";
  return;
 }

 data.forEach(item=>{
  const wrap=document.createElement("div");
  wrap.className="issue-item";

  const h=document.createElement("div");
  h.className="issue-header";
  h.innerHTML=`${item.issue}<span class="arrow">‚Ä∫</span>`;

  const d=document.createElement("div");
  d.className="issue-detail";
  d.innerHTML=`
   <div class="section">
    <h4>Solusi</h4>
    ${nl(item.solusi)||"-"}
   </div>
   ${
    item.image_id && item.image_id!=="kosong"
    ?`<img src="https://drive.google.com/thumbnail?id=${item.image_id}&sz=w1200">`
    :""
   }
  `;

  h.onclick=()=>{
   document.querySelectorAll(".issue-item").forEach(i=>{
    i.classList.remove("open");
    i.querySelector(".issue-detail").style.display="none";
   });

   wrap.classList.add("open");
   d.style.display="block";
  };

  wrap.appendChild(h);
  wrap.appendChild(d);
  list.appendChild(wrap);
 });
}

/* SEARCH */
document.getElementById("search").addEventListener("input",e=>{
 const k=e.target.value.toLowerCase().trim();
 if(!k){
  document.getElementById("list").innerHTML=
   "<div class='empty'>Ketik kata kunci untuk mencari issue</div>";
  return;
 }
 render(issues.filter(i=>i.issue.toLowerCase().includes(k)));
});
</script>

</body>
</html>
